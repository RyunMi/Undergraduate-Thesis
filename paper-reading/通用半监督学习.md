# 通用半监督学习

## 引用方式

### GB/T 7714

<span style="background-color: rgb(255, 255, 255)">Huang Z, Xue C, Han B, et al. Universal semi-supervised learning[J]. Advances in Neural Information Processing Systems, 2021, 34: 26714-26725.</span>

### Bibtex

    @article{huang2021universal,
      title={Universal semi-supervised learning},
      author={Huang, Zhuo and Xue, Chao and Han, Bo and Yang, Jian and Gong, Chen},
      journal={Advances in Neural Information Processing Systems},
      volume={34},
      pages={26714--26725},
      year={2021}
    }

## 开源代码

[zhuohuangai/cafa-1: Code for \`\`NIPS 2021 universal semi-supervised learning'' (github.com)](https://github.com/zhuohuangai/cafa-1)

## 主要思想

通用半监督学习旨在解决开集问题，其中标记数据集和未标记数据集的类分布和特征分布都不同，这样的问题严重阻碍了经典SSL的现实落地。与现有的针对开集问题的SSL方法不同，现有的SSL方法只研究类分布不匹配的一种特定情况，而忽略了特征分布不匹配。

本文考虑了一种更普遍的情况，即类和特征分布都存在不匹配。在这种情况下，提出了一个“类共享数据检测和特征自适应”(CAFA)框架，该框架不需要事先知道标记数据集和未标记数据集之间的类关系。特别地，CAFA利用一种新颖的评分策略来检测共享类集中的数据。然后，它进行域适应，以充分利用检测到的类共享数据的价值，进行更好的半监督一致性训练。

在几个基准数据集上进行的详尽实验表明了本文的方法在解决开集问题方面的有效性。

## 主要内容

### 引论

在实践中，手头的数据集可能会有类分布不匹配和特征分布不匹配的情况，这被表示为开集SSL(不仅关注类分布不匹配，也关注特征分布不匹配的问题)。

![\<img alt="" data-attachment-key="CZ2QH29H" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22U82RL8BM%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%222%22%2C%22position%22%3A%7B%22pageIndex%22%3A1%2C%22rects%22%3A%5B%5B145.259%2C606.767%2C462.8%2C732.883%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%222%22%7D%7D" width="529" height="210" src="attachments/CZ2QH29H.png" ztype="zimage">](attachments/CZ2QH29H.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%222%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 2</a></span>)</span>

现有的方法需要事先了解 $\mathcal{C}^l$ 和 $\mathcal{C}^u$ 之间的关系，这大大限制了它们的实际应用。当类关系未知时，来自 $\mathcal{D}^l$ 和 $\mathcal{D}^u$ 的潜在私有数据都可能严重误导学习过程。

此外，现有的工作只考虑类分布不匹配\[图中(a),(b),(c)]，而完全忽略了特征分布不匹配的问题。这在实践中很常见，因为当试图收集大量未标记数据来帮助模型训练时，新获得的未标记数据的特征分布可能会受到何时、何地以及如何收集它们的方式的严重影响。

### 通用半监督学习

标签集 $\mathcal{D}^l=\{(x_i,y_i)\}^l_{i=1}$ 包含 $l$ 个附标签 $\{y_i\}^l_{i=1}$ 的实例 $x_i$ ，无标签集 $\mathcal{D}^u=\{(x_j)\}^u_{j=1}$ 包含 $u$ 个无标签实例 $x_j$  ，其中 $l\ll u$ 。

两个数据集 $\mathcal{D}^l$ 和 $\mathcal{D}^u$ 分别来自两个不同的特征分布 $p^l(x_i)$ 和 $p^u(x_j)$ 。

使用 $\mathcal{C}^l$ 表示包含标记数据类的标记类集合，使用 $\mathcal{C}^u$ 表示由未标记数据类组成的未标记类集合。 $\mathcal{C}^l$ 和 $\mathcal{C}^u$ 的准确关系是未知的。

使用 $\mathcal{C}=\mathcal{C}\^l \cap \mathcal{C}\^u$  来表示 $\mathcal{D}^l$ 和 $\mathcal{D}^u$ 共享的公共类集，并使用 $\overline{\mathcal{C}}^l$ 和 $\overline{\mathcal{C}}^u$ 来分别表示标记数据和未标记数据专用的类集。

标签位于 $\mathcal{C}$ 和 $\overline{\mathcal{C}}^l$ 中的标记数据的特征分布分别表示为 $p^l_{\mathcal{C}}(x_i)$ 和 $p^l_{\overline{\mathcal{C}}^l}(x_i)$ ，属于 $\mathcal{C}$ 和 $\overline{\mathcal{C}}^u$ 的未标记数据的特征分布分别表示为 $p^u_{\mathcal{C}}(x_j)$ 和 $p^u_{\overline{\mathcal{C}}^u}(x_j)$ 。

本文的目标是有效地识别来自 $\mathcal{D}^l$ 和 $\mathcal{D}^u$ 的类共享数据，然后消除已识别的标记数据和未标记数据之间的特征分布不匹配，以帮助训练准确的半监督模型，将测试数据分类为感兴趣的类 $\mathcal{C}^l$ 。

#### CAFA的总体框架

![\<img alt="" data-attachment-key="EXF3BT4Z" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22EZVKQEDN%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%223%22%2C%22position%22%3A%7B%22pageIndex%22%3A2%2C%22rects%22%3A%5B%5B149.59374253203694%2C580.305%2C462.6314610232972%2C720.9471958304285%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%223%22%7D%7D" width="522" height="235" src="attachments/EXF3BT4Z.png" ztype="zimage">](attachments/EXF3BT4Z.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%223%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 3</a></span>)</span>

特征提取器 $F$ ：输入实例 $x$ ，经过卷积层，输出特征表示 $z=F(x)$ 。

分类器 $C$ ：使用 $z$ 输出标签预测 $f$ 。

非对抗性域判别器 $D'$ ：生成一个域相似性得分 $w_d$ ，该得分量化实例与一个分布的相似程度。

对抗性域判别器 $D$ ：旨在对有标签和无标签数据的特征分布进行对抗性调整，以适应公共类别 $C$ 。

CAFA的总体框架可以简明地表述为：

![\<img alt="" data-attachment-key="AGHR8Y6V" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%226WDLRFDY%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%223%22%2C%22position%22%3A%7B%22pageIndex%22%3A2%2C%22rects%22%3A%5B%5B132.872%2C248.68799999999996%2C480.817%2C309.944427349859%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%223%22%7D%7D" width="580" height="102" src="attachments/AGHR8Y6V.png" ztype="zimage">](attachments/AGHR8Y6V.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%223%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 3</a></span>)</span>

第一项称为监督保真度项，它涉及标准的交叉熵损失 $\mathcal{L}_{ce}(\cdot)$ 。

第二项被称为特征自适应项，它引入了对抗性学习损失 $\mathcal{L}_{adv}$ 对来自 $\mathcal{D}^l$ 和 $\mathcal{D}^u$ 的类共享数据进行特征自适应。这里通过两个分数 $w^l$ 和 $w^u$ 检测类共享数据。通过这样的特征自适应过程，CAFA方法可以最大限度地利用未标记的数据，并有利于SSL。

第三个项是指类共享数据探索项，它使用SSL损失 $\mathcal{L}_{ssl}(\cdot)$ 进行半监督训练，以充分利用类共享未标记的数据。这里SSL损失可以是现有方法中的任何正则化项，如一致性正则化项或流形正则化项。 $y_j$ 是一个 $|\mathcal{C}^l|$ 维向量，表示每个未标记数据 $x_j$ 生成的伪学习目标。

#### 类共享数据检测

类共享数据检测旨在正确区分属于  $\mathcal{C}$  的训练数据和  $\overline{\mathcal{C}}\^l \cup \overline{\mathcal{C}}\^u$  中的训练数据。为了实现这个目标，希望对有标签和无标签数据分别建模两个类共享分数 $w^l(\cdot)$ 和 $w^u(\cdot)$ ，应满足以下不等式：

![\<img alt="" data-attachment-key="GZ78TZF4" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22RGJF7QHX%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%224%22%2C%22position%22%3A%7B%22pageIndex%22%3A3%2C%22rects%22%3A%5B%5B237.03%2C495.853%2C368.213%2C533.012%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%7D" width="219" height="62" src="attachments/GZ78TZF4.png" ztype="zimage">](attachments/GZ78TZF4.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 4</a></span>)</span>

上述不等式应该在较大范围内保持，以获得更好的检测性能。在这里利用两个线索，即域相似度 $w_d$ 和标签预测偏移 $w_s$ ，来建模 $w^l$ 和 $w^u$ 。

##### 域相似度

通常训练非对抗性域判别器 $D'$ ，通过最小化交叉熵损失预测来自 $p^l$ 的数据为0，来自 $p^u$ 的数据为1。输出值 $w_d＝D'(F(x))$ 可以被认为是输入 $x$ 的域相似性。如果 $w_d$ 很大，则输入 $x$ 很可能是从 $p^u$ 采样的，否则是从 $p^l$ 采样的：

![\<img alt="" data-attachment-key="IZCHBP4V" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22PR2HXCM6%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%224%22%2C%22position%22%3A%7B%22pageIndex%22%3A3%2C%22rects%22%3A%5B%5B183.37479129008662%2C385.9517870554711%2C424.515%2C405.77000000000004%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%7D" width="402" height="33" src="attachments/IZCHBP4V.png" ztype="zimage">](attachments/IZCHBP4V.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 4</a></span>)</span>

然而，这种训练策略缺乏对两个特征分布之间中间区域的利用，容易出现过拟合的情况，即 $\mathbb{E}\_{\mathbf{x} \sim p_{\overline{\mathcal{C}}^l}^l} w_d(\mathbf{x}) \approx \mathbb{E}\_{\mathbf{x} \sim p_{\mathcal{C}}^l} w_d(\mathbf{x}) \approx 0$ 和 $\mathbb{E}\_{\mathbf{x} \sim p_{\overline{\mathcal{C}}^u}^u} w_d(\mathbf{x}) \approx \mathbb{E}\_{\mathbf{x} \sim p_{\mathcal{C}}^u} w_d(\mathbf{x}) \approx1$ ，从而导致类共享数据无法识别，如下图所示：

![\<img alt="" data-attachment-key="ZBM8KJZ5" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22NTJIXHIY%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%224%22%2C%22position%22%3A%7B%22pageIndex%22%3A3%2C%22rects%22%3A%5B%5B163.838%2C674.5545503814612%2C275.879%2C720.4969999999998%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%7D" width="187" height="77" src="attachments/ZBM8KJZ5.png" ztype="zimage">](attachments/ZBM8KJZ5.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 4</a></span>)</span>

为了解决这个问题，使用Mixup来加强 $x_i\sim p_{\mathcal{C}}^l$ 和 $x_j\sim p_{\mathcal{C}}^u$ 之间的关系，以产生具有区分性的域相似度。

具体来说，给定有标签数据 $x_i$ 和无标签数据 $x_j$ 的两个特征表示 $z_i=F(x_i)$ 和 $z_j=F(x_j)$ ，以及它们对应的域标签 $d_i=0$ 和 $d_i=1$ 。可生成一个混合特征表示 $\tilde{z}\_{i,j}$ 和一个混合域标签 $\tilde{d}\_{i,j}$ ：

![\<img alt="" data-attachment-key="3YT542J9" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22KNNALNMB%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%224%22%2C%22position%22%3A%7B%22pageIndex%22%3A3%2C%22rects%22%3A%5B%5B221.26599999999996%2C258.82200000000006%2C386.22999999999996%2C276.2759889604417%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%7D" width="275" height="29" src="attachments/3YT542J9.png" ztype="zimage">](attachments/3YT542J9.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 4</a></span>)</span>

其中 $\lambda$ 取自Beta分布 $Beta(\alpha,\alpha)$ ( $\alpha$ 是超参数)。

然后，通过在领域相似性损失 $\mathcal{L}_{dom}$ 中添加一个额外的二元交叉熵项来利用带有其领域标签的混合特征表示：

![\<img alt="" data-attachment-key="ULC6TGSE" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22SDZ622DU%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%224%22%2C%22position%22%3A%7B%22pageIndex%22%3A3%2C%22rects%22%3A%5B%5B122.738%2C185.06700000000006%2C472.93499999999995%2C218.1725782238243%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%7D" width="584" height="55" src="attachments/ULC6TGSE.png" ztype="zimage">](attachments/ULC6TGSE.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 4</a></span>)</span>

其中 $sim(z_i,z_j)=\frac{z_i^{\top}z_j}{||z_i||||z_j||}$ 表示 $z_i$ 和 $z_j$ 之间的余弦相似度。

对 $\mathcal{L}\_{dom}$ 最小化，提取前两项负号，意味着找到 $D'$ 使得 $D'(z_i)$ 足够小， $D'(z_j)$ 足够大。对于最后一项，权重 $sim(z_i,z_j)$ 意味着更多的考虑类共享数据，将 $[\cdot]$ 中负号提取，意味着找到 $D'$ 使得附带混合域标签 $\tilde{d}\_{i,j}$ 的混合特征表示数据的输出 $D'(\tilde{z}\_{i,j})$ 足够大，其余混合特征表示数据的输出足够小。

基于 $C$ 中的 $z_i$ 和 $z_j$ 比 $\overline{\mathcal{C}}^l$ 和 $\overline{\mathcal{C}}^u$ 中的 $z_i$ 和 $z_j$ 在特征空间中更接近的合理假设，这种基于余弦相似度加权的额外项可以专注于插值两个特征分布 $p^l_{\mathcal{C}}$ 和 $p^u_{\mathcal{C}}$ 之间的中间区域，这有助于防止前述的过拟合问题，并使类共享数据的领域相似度比 $\overline{\mathcal{C}}^l$ 和 $\overline{\mathcal{C}}^u$ 中的私有数据更接近，如下图所示：

![\<img alt="" data-attachment-key="32X6QV74" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22MCW5L4S8%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%224%22%2C%22position%22%3A%7B%22pageIndex%22%3A3%2C%22rects%22%3A%5B%5B163.275%2C628.162%2C275.879%2C673.8789311244933%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%7D" width="188" height="76" src="attachments/32X6QV74.png" ztype="zimage">](attachments/32X6QV74.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 4</a></span>)</span>

因此有：

![\<img alt="" data-attachment-key="KSCBK74D" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%225BPVB8QJ%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%224%22%2C%22position%22%3A%7B%22pageIndex%22%3A3%2C%22rects%22%3A%5B%5B106.973%2C87.665%2C372.718%2C104.556%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%7D" width="443" height="28" src="attachments/KSCBK74D.png" ztype="zimage">](attachments/KSCBK74D.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 4</a></span>)</span>

结合前述，可得：

![\<img alt="" data-attachment-key="IQ6D356J" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22ZUGN7V7W%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%224%22%2C%22position%22%3A%7B%22pageIndex%22%3A3%2C%22rects%22%3A%5B%5B172.846%2C65.144%2C434.649%2C84.287%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%7D" width="436" height="32" src="attachments/IQ6D356J.png" ztype="zimage">](attachments/IQ6D356J.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 4</a></span>)</span>

当配备Mixup训练时，上述不等式会比传统训练策略产生更大的差值，因此域相似度可以更好地检测开集情况下的类共享数据。然而，仅通过域相似度并不足以检测类共享数据，因此引入标签预测偏移来增强检测性能。

##### 标签预测偏移

对每个实例施加对抗扰动的影响，可以成功区分类共享数据和私有数据，如下图所示：

![\<img alt="" data-attachment-key="PZGTZRQB" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22EKECP3IS%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%224%22%2C%22position%22%3A%7B%22pageIndex%22%3A3%2C%22rects%22%3A%5B%5B312.475%2C633.229%2C446.473%2C724.438%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%7D" width="223" height="152" src="attachments/PZGTZRQB.png" ztype="zimage">](attachments/PZGTZRQB.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%224%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 4</a></span>)</span>

形式上，给定一个输入实例 $x$ ，其标签预测可以表示为 $f=[f_1(x),f_2(x),\cdots,f_{|\mathcal{C}^l|}(x)]^\top$ ，其中 $\{f_i(x)\}\_{i=1}^{|\mathcal{C}^l|}$ 可理解为 $x$ 属于第 $i$ 类的概率。然后在 $x$ 上施加一个对抗扰动来获得输入实例的扰动版本 $x^{\*}=x-\epsilon sign(-\nabla_x\mathcal{L}\_{ce}(x,\max_{i\in\{1,\cdots,|\mathcal{C^l}|\}} f_i(x)))$ ，其中 $\epsilon$ 控制扰动量的大小。对抗扰动会降低给定输入的最大概率，则标签预测偏移可以计算为：

![\<img alt="" data-attachment-key="H3P3C6KP" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22EPL944PF%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%225%22%2C%22position%22%3A%7B%22pageIndex%22%3A4%2C%22rects%22%3A%5B%5B237.593%2C555.533%2C368.213%2C576.364%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%225%22%7D%7D" width="218" height="35" src="attachments/H3P3C6KP.png" ztype="zimage">](attachments/H3P3C6KP.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%225%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 5</a></span>)</span>

因此，计算的标签预测偏移将满足以下不等式：

![\<img alt="" data-attachment-key="J6B8YENM" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22NZNJESWN%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%225%22%2C%22position%22%3A%7B%22pageIndex%22%3A4%2C%22rects%22%3A%5B%5B172.84600000000003%2C524.567%2C432.96%2C543.2588759267011%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%225%22%7D%7D" width="434" height="31" src="attachments/J6B8YENM.png" ztype="zimage">](attachments/J6B8YENM.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%225%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 5</a></span>)</span>

直觉上，对稀缺有标签数据的学习强烈依赖于有监督的交叉熵损失 $\mathcal{L}\_{ce}$ ，而通过一致性正则化学习的无标签数据对扰动具有更强的鲁棒性。因此：  $\mathbb{E}\_{\mathbf{x} \sim p_{\overline{\mathcal{C}}\^u}\^u} w_s(\mathbf{x}),\mathbb{E}\_{\mathbf{x} \sim p_{\mathcal{C}}\^u} w_s(\mathbf{x}) < \mathbb{E}\_{\mathbf{x} \sim p_{\overline{\mathcal{C}}\^l}\^l} w_s(\mathbf{x}),\mathbb{E}\_{\mathbf{x} \sim p_{\mathcal{C}}^l} w_s(\mathbf{x})$

此外，丰富的未标记数据具有提高SSL中模型泛化性的效果。在开集情况下，类集 $\overline{\mathcal{C}}^l$ 上的模型泛化性受到极大限制，因为只有稀缺的标记私有数据可用，这使得这类数据容易受到扰动。与 $\overline{\mathcal{C}}^l$ 相反， $\\mathcal{C}$ 中类的模型学习是充足的，因其既有标记数据也有未标记数据可利用。因此： $\mathbb{E}\_{\mathbf{x} \sim p_{\mathcal{C}}^l} w_s(\mathbf{x})<\mathbb{E}\_{\mathbf{x} \sim p_{\overline{\mathcal{C}}^l}^l} w_s(\mathbf{x})$ 。

此外， $\overline{\mathcal{C}}^u$ 中未标记的私有数据不属于任何已知的类，并且完全不在任何已知分布中。与 $\mathcal{C}^l$ 中的数据相比，对抗性扰动对其最大标签预测的影响较小。因此： $\mathbb{E}\_{\mathbf{x} \sim p_{\overline{\mathcal{C}}^u}^u} w_s(\mathbf{x})<\mathbb{E}\_{\mathbf{x} \sim p_{\mathcal{C}}^u} w_s(\mathbf{x})$ 。

整合 $w_d,w_s$ ，可通过下式计算 $w^l,w^u$ ：

![\<img alt="" data-attachment-key="FVH9Y5HX" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22YXBSNBY5%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%225%22%2C%22position%22%3A%7B%22pageIndex%22%3A4%2C%22rects%22%3A%5B%5B227.459%2C305.553%2C381.163%2C337.082%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%225%22%7D%7D" width="256" height="53" src="attachments/FVH9Y5HX.png" ztype="zimage">](attachments/FVH9Y5HX.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%225%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 5</a></span>)</span>

在计算之前， $w_d,w_s$ 都被标准化为区间\[0,1]。

#### 特征自适应

检测到类共享数据后，应该消除 $p^l_\mathcal{C}$ 和 $p^u_\mathcal{C}$ 之间的特征分布不匹配，以便可以正确提取未标记数据的值，以帮助后续的SSL。

为此，将标记数据作为目标域( $d_i=0,x_i\in\mathcal{D}^l$ )，将未标记数据作为源域( $d_j=1,x_j\in\mathcal{D}^u$ )，并进行对抗性域适应\[以实现这一目标。

特别地，将类共享分数 $w^l,w^u$ 应用于对抗性学习损失 $\mathcal{L}_{adv}$ ，并训练对抗性鉴别器 $D$ 来区分标记数据和未标记数据。同时，对特征提取器 $F$ 进行训练以欺骗 $D$ ：

![\<img alt="" data-attachment-key="GK4N2E3S" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22Q37YF2XD%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%225%22%2C%22position%22%3A%7B%22pageIndex%22%3A4%2C%22rects%22%3A%5B%5B127.805%2C116.942%2C468.994%2C152.412%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%225%22%7D%7D" width="569" height="59" src="attachments/GK4N2E3S.png" ztype="zimage">](attachments/GK4N2E3S.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%225%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 5</a></span>)</span>

特征自适应可以重新发现未标记数据的价值，并提高SSL性能。

#### 半监督训练

$\overline{\mathcal{C}}^l$ 中的私有数据可能会误导未标记的数据传输到错误的类， $\overline{\mathcal{C}}^u$ 中的未标记私有数据可能被错误地纳入网络训练，导致性能进一步下降。为了解决这个问题，提出以下SSL训练策略：

![\<img alt="" data-attachment-key="LMD65YXH" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22C49H7MU6%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%226%22%2C%22position%22%3A%7B%22pageIndex%22%3A5%2C%22rects%22%3A%5B%5B238.15599999999998%2C597.759%2C369.1705594593598%2C619.154%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%226%22%7D%7D" width="218" height="36" src="attachments/LMD65YXH.png" ztype="zimage">](attachments/LMD65YXH.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%226%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 6</a></span>)</span>

其中 $w^u(x)$ 用于削弱未标记私有数据的网络学习，而 $\hat{y}$ 表示每个未标记数据的校准伪目标，以减轻标记私有数据引入的误导性偏差。

为了校准原始偏置伪目标 $y$ ，使用加权softmax函数。特别地，将 $w^l$ 相对于每个类 $c$ 的平均权重计算为：

![\<img alt="" data-attachment-key="Q432W3P4" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22JUIXYDDH%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%226%22%2C%22position%22%3A%7B%22pageIndex%22%3A5%2C%22rects%22%3A%5B%5B218.451%2C510.491%2C391.297%2C542.02%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%226%22%7D%7D" width="288" height="53" src="attachments/Q432W3P4.png" ztype="zimage">](attachments/Q432W3P4.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%226%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 6</a></span>)</span>

基于前文，如果 $c$ 在 $\mathcal{C}$ 中，则计算的权重 $w_c^{avg}$ 将较大，如果 $c$ 位于 $\overline{\mathcal{C}}^l$ 中，则会较小。可以通过下式校准伪目标 $y$ ：

![\<img alt="" data-attachment-key="T7WFXDJJ" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22FWJZBZA6%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%226%22%2C%22position%22%3A%7B%22pageIndex%22%3A5%2C%22rects%22%3A%5B%5B224.644%2C444.055%2C383.978%2C475.021%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%226%22%7D%7D" width="266" height="52" src="attachments/T7WFXDJJ.png" ztype="zimage">](attachments/T7WFXDJJ.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%226%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 6</a></span>)</span>

其中记号 $[\cdot]_c$ 表示输入的第 $c$ 项。通过这样的过程，属于 $\overline{\mathcal{C}}^l$ 的 $\hat{y}$ 会被抑制，属于 $\mathcal{C}$ 的 $\hat{y}$ 会被增强，从而成功地缓解了原始目标 $y$ 导致的偏差。

## 结论及改进方向

### 实验

使用CIFAR-10、Office-31和VisDA2017来评估方法。将CIFAR-10中的10个类表示为“0”～“9”，将Office-31中的31个类表示为由“0”\~“30”，将VisDA2017中的12个类表示由“0”〜“11”。Office-31数据集包含三个域(A、D、W)，VisDA2017包含两个域(模拟、现实)。CIFAR-10、Office-31和VisDA2017中已标记实例的数量分别设置为2400、100和1800，CIFAR-10和Office-31中未标记实例的数目分别设置为20000、400和20000。

使用CIFAR-10来构建类分布不匹配的数据集，其中包含两种场景：对于子集不匹配，从“0”～“5”中选择类来形成 $\mathcal{C}^l$ ，从“0“～”8“中选择类形成 $\mathcal{C}^u$ ；对于交叉不匹配，从“0”～“5”中选择类来形成 $\mathcal{C}^l$ ，从“3”～“8”中选择类别来形成 $\mathcal{C}^u$ 。

选择来自不同领域的标记数据和未标记数据来产生特征分布不匹配。

在Office-31中，有六种“标记数据域/未标记数据域”的组合，包括“A/D”、“A/W”、“D/A”、“D/C”、“W/A”和“W/D”。对于子集不匹配，选择“0”～“19”中的类作为 $\mathcal{C}^l$ ，选择“0“～”29“中的类为 $\mathcal{C}^u$ ；对于交叉失配，选择“0”～“19”中的类作为 $\mathcal{C}^l$ ，选择“9”～“29”中的类别作为 $\mathcal{C}^u$ 。

在VisDA2017中，选择现实域作为标记数据域，选择模拟域作为未标记数据域。对于子集不匹配，选择“0”～“8”中的类作为 $\mathcal{C}^l$ ，选择“0”～“11”中的类形成 $\mathcal{C}^u$ ；对于交叉失配，选择“0”～“8”中的类作为 $\mathcal{C}^l$ ，选择“3”～“11”类形成 $\mathcal{C}^u$ 。

对于所有实验，从与标记数据集相同的特征和类分布中采样的数据集上进行测试。

使用在ImageNet上预先训练的ResNet-50作为骨干网络。CIFAR-10数据集的批量大小设置为100，其他数据集的批次大小设置为64。SGD优化器。

#### 开集评估

为了证明方法在类分布不匹配的情况下的有效性，而不需要 $\mathcal{C}^l$ 和 $\mathcal{C}^u$ 之间的先验关系，在CIFAR-10数据集中创建了子集不匹配和交叉不匹配。

![\<img alt="" data-attachment-key="9KFL8MTQ" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%228SNDXWYM%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%228%22%2C%22position%22%3A%7B%22pageIndex%22%3A7%2C%22rects%22%3A%5B%5B327.113%2C256.007%2C505.59%2C382.123%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%228%22%7D%7D" width="297" height="210" src="attachments/9KFL8MTQ.png" ztype="zimage">](attachments/9KFL8MTQ.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%228%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 8</a></span>)</span>

然后考虑了特征分布不匹配问题，其中当 $\mathcal{C}^l=\mathcal{C}^u$ 时，标记数据和未标记数据从不同域采样。在这种情况下，几乎所有的闭集和开集方法都比监督基线表现出严重的性能退化。

![\<img alt="" data-attachment-key="32CJ79KS" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%222IGBLPTA%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%228%22%2C%22position%22%3A%7B%22pageIndex%22%3A7%2C%22rects%22%3A%5B%5B165.527%2C567.356%2C447.036%2C688.405%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%228%22%7D%7D" width="469" height="202" src="attachments/32CJ79KS.png" ztype="zimage">](attachments/32CJ79KS.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%228%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 8</a></span>)</span>

最后，在特征分布不匹配和类分布不匹配的情况下进行了实验。这里后者还包括两种情况：子集不匹配和交叉不匹配。

![\<img alt="" data-attachment-key="GKV4VR3Z" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22J99RRBK6%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%229%22%2C%22position%22%3A%7B%22pageIndex%22%3A8%2C%22rects%22%3A%5B%5B104.158%2C579.742%2C507.842%2C712.615%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%229%22%7D%7D" width="673" height="222" src="attachments/GKV4VR3Z.png" ztype="zimage">](attachments/GKV4VR3Z.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%229%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 9</a></span>)</span>

#### 性能分析

![\<img alt="" data-attachment-key="BU23A74N" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22E5824MUM%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%229%22%2C%22position%22%3A%7B%22pageIndex%22%3A8%2C%22rects%22%3A%5B%5B275.316%2C480.651%2C497.144%2C571.297%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%229%22%7D%7D" width="370" height="151" src="attachments/BU23A74N.png" ztype="zimage">](attachments/BU23A74N.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%229%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 9</a></span>)</span>

从上图类共享分数 $w^l$ 和 $w^u$ 的概率密度曲线可以看出，类共享数据和私有数据之间的分数分布是明显可分离的，从而验证了本文的假设。

![\<img alt="" data-attachment-key="6E4UD6FT" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%22TLA3RCKN%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%229%22%2C%22position%22%3A%7B%22pageIndex%22%3A8%2C%22rects%22%3A%5B%5B273.626%2C337.082%2C392.423%2C428.854%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%229%22%7D%7D" width="198" height="153" src="attachments/6E4UD6FT.png" ztype="zimage">](attachments/6E4UD6FT.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%229%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 9</a></span>)</span>

从上图每个类别 $c$ 的平均权重 $w^{avg}_c$ 可以看到，当 $c$ 在 $\overline{\mathcal{C}}^l$ 中时， $w^{avg}_c$ 很小，而当 $c$ 属于 $\mathcal{C}$ 时， $w^{avg}_c$ 很大。因此伪目标校准有助于减轻未标记数据的学习偏差。

将标记私有类 $\mathcal{C}^l$ 的数量设置为等于未标记私有类 $\mathcal{C}^u$ ，因此共享类的数量从20到10不等。证明鲁棒性。

![\<img alt="" data-attachment-key="IMRWP3CY" data-annotation="%7B%22attachmentURI%22%3A%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FF5U7CMRR%22%2C%22annotationKey%22%3A%224M6MLIC2%22%2C%22color%22%3A%22%23ffd400%22%2C%22pageLabel%22%3A%229%22%2C%22position%22%3A%7B%22pageIndex%22%3A8%2C%22rects%22%3A%5B%5B392.8172935899946%2C336.74407998289456%2C507.2789999999998%2C427.389894150328%5D%5D%7D%2C%22citationItem%22%3A%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%229%22%7D%7D" width="191" height="151" src="attachments/IMRWP3CY.png" ztype="zimage">](attachments/IMRWP3CY.png)\
<span class="citation" data-citation="%7B%22citationItems%22%3A%5B%7B%22uris%22%3A%5B%22http%3A%2F%2Fzotero.org%2Fusers%2F8273795%2Fitems%2FE6BI2ENB%22%5D%2C%22locator%22%3A%229%22%7D%5D%2C%22properties%22%3A%7B%7D%7D" ztype="zcitation">(<span class="citation-item"><a href="zotero://select/library/items/E6BI2ENB">Huang 等, p. 9</a></span>)</span>

### 未来工作

所提出的方法在计算上是昂贵的：在每一轮中，方法都需要额外的反向传播来获得对抗性扰动。因此，有必要在未来的工作中同时考虑有效性和效率。
